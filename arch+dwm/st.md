Апрель 06, 2020 • 2 мин. чтения

В последнее время я просматривал программы Suckless и захотел попробовать [st-терминал](https://st.suckless.org/). Хотя я не могу сказать, что это особенно сложно настроить, на этом пути определенно были некоторые подводные камни. Я опишу их здесь, чтобы, надеюсь, сэкономить вам время, если вы тоже заинтересованы в настройке st.

## Почему st

Я хотел попробовать что-то новое от [urxvt](https://wiki.archlinux.org/index.php/Rxvt-unicode). Что-то более минималистичное. Вот тут-то и вступает в игру Suckless. Их философия заключается в абсолютном минимализме и расширяемости. Это быстро становится ясным, когда вы читаете вступление к терминалу st, в котором говорится:

> Популярная альтернатива, rxvt, имеет _всего_ 32 тысячи строк кода. Это слишком много для чего-то такого простого, как эмулятор терминала; Это еще один пример сложности кода.

## Установка

Вопреки тому, как это может показаться на первый взгляд, установка st на самом деле довольно тривиальна. Мы практически просто выполняем две команды. Однако для выполнения этих команд вам понадобится какой-нибудь другой терминал.

1. Получение исходного кода Это можно сделать с помощью или напрямую, загрузив предоставленный архив и распаковав его с помощью . Убедитесь, что вы делаете это в каталоге, в котором вы хотите, чтобы находилась ваша извлеченная папка st. Я позвонил своему. `git clone https://git.suckless.org/st``tar -xf``programs`
    
2. Установка программы Это так же просто, как запуск из каталога, в котором находится исходный код. `sudo make clean install`
    
3. Настройка st Так как st собирается из исходных текстов, конфигурацию можно найти в файле C. Я выбираю редактирование, потому что патчи применяют свои изменения конфигурации там. Новая версия создается после компиляции, если она еще не существует. Если вы оставите его, вы должны объединить его обратно после того, как вы или патчи применят туда изменения. `config.h``config.def.h``config.h``config.h``config.def.h`
    

## Наложение заплаты

Скорее всего, вам не хватает какой-то функциональности при запуске простой установки st. В конце концов, программы Suckless должны быть как можно более минимальными. Это не значит, что вы останетесь в пыли, если вам нужно что-то вроде поддержки прокрутки. [Патчи ST](https://st.suckless.org/patches/) предоставляют вам простой способ добавить некоторые дополнительные функции.

Лично я выбрала для применения следующие патчи:

- scrollback (для поддержки прокрутки)
- vertcenter (для вертикального центрирования текста на строках)
- xresources (для того, чтобы использовать цветовую схему, сгенерированную [pywal](https://github.com/dylanaraps/pywal))
- externalpipe (чтение экрана st's через канал для распознавания URL-адреса)

Все это хорошо, но как вы наносите эти патчи? Именно здесь становится очевидным, как мало документация направляет вас. За исключением нескольких команд в нижней части [страницы взлома](https://suckless.org/hacking/), вы должны разобраться в этом самостоятельно.

## 
Вот как я это сделал:

1. Загрузите патч в папку st. Я выбираю создание вложенной папки с именем `patches`
2. Наложите пластырь с помощью . При этом будет использоваться нотация конфликта слияния, если возникнут проблемы с применением исправления к текущей сборке`patch --merge -i /path/to/patch.diff`
3. Перестройте st с помощью . Это сгенерирует актуальный конфигурационный файл и скомпилирует последние изменения в вашу новую сборку `rm -rf config.h && sudo make clean install`

Рекомендуется хранить исходный код в Git. Таким образом, вы можете легко выполнить откат, если что-то сломается.

---

Как видите, весь этот процесс не совсем ракетостроение. Однако из-за документации Suckless или ее отсутствия, на это может уйти довольно много времени. Это не значит, что я жалею, что установил st, так как он научил меня командам и . Это также моя первая вылазка в мир C.`diff``patch`

Если вам интересно: вы можете найти мою конкретную сборку st в ее собственном [репозитории GitHub](https://github.com/Martijnvos/st).

Удачной компиляции!