Вот как смонтировать USB-накопитель вручную:

Определение имени блочного устройства USB-накопителя

TLDR: подключите USB-накопитель и используйте для идентификации (1) USB-накопителя и (2) его раздела данных, который может выглядеть примерно так: (1) и (2) соответственно. Теперь можно перейти к монтированию USB-накопителя. Конец TLDRlsblksdbsdb1

Во-первых, немного терминологии: ядро Linux классифицирует USB-накопитель как блочное устройство (потому что данные записываются на диск и считываются с него блоками фиксированного размера). Как правило, USB-накопитель делится на несколько разделов; Раздел USB-накопителя, содержащий полезные файлы и данные, называется разделом данных.

Ниже описано, как определить имя устройства USB-накопителя и имя раздела данных.

Перед подключением USB-накопителя к компьютеру выполните команду ("list block devices") из оболочки, чтобы получить список имен доступных в данный момент блочных устройств. Идея состоит в том, чтобы получить представление о доступных блочных устройствах перед установкой USB-накопителя, чтобы было легко увидеть изменения, происходящие после подключения USB-накопителя.lsblk

Подключите USB-накопитель и подождите около того, пока ваша ОС обнаружит его.

Запустите еще раз. Вы должны увидеть новую запись (часто ), которая идентифицирует ваш USB-накопитель, и некоторые пронумерованные записи (например, , ) под ним — пронумерованные записи идентифицируют разделы на USB-накопителе. (Возможно, будет полезно ориентироваться по размеру каждого блочного устройства и раздела, поскольку вы, вероятно, заранее знаете, насколько велик ваш USB-накопитель.)lsblksdbsdb1sdb2
```
$ lsblk 
# Before             # After
NAME                 NAME
sda                  sda
├─sda1               ├─sda1
├─sda2     ---->     ├─sda2
├─sda3               ├─sda3
└─sda4               └─sda4
                     sdb       <-- USB drive
                     └─sdb1    <-- USB drive data partition
```
Устранение неполадок: если диск не отображается при попытке перезагрузить компьютер — у меня иногда возникала эта проблема, когда я забывал перезагрузиться после обновления ядра операционной системы.lsblk

Вам нужно определить две вещи:

Идентификатор USB-накопителя (например, или ). Я буду использовать, чтобы избежать риска того, что вы слепо скопируете , что может быть чем-то другим на вашем компьютере - замените the на соответствующую букву в вашей системе (которая все еще может быть ).sdbnvme0n1sdxsdbxb

Идентификатор раздела данных диска, который будет идентификатором диска, за которым следует целое число (например, или ). Раздел данных должен быть разделом, размер которого примерно соответствует объему памяти вашего USB-накопителя. Я буду использовать —замените the на число на вашем компьютере.sdb1nvme0n1p1sdxNN

Запомните эти два идентификатора на будущее.

Подключите USB-накопитель
TLDR: создайте каталог монтирования, а затем смонтируйте диск в каталог монтирования с помощью :mount
```
# TLDR: create a mount point and mount the drive
sudo mkdir /mnt/usbdrive            # create a mount point (if needed)
sudo mount /dev/sdxN /mnt/usbdrive  # mount the drive's data partition
Теперь можно перейти к извлечению USB-накопителя.
```
Более подробно: точка монтирования — это место в одной файловой системе, из которого вы взаимодействуете со второй файловой системой; В нашем контексте точка монтирования — это каталог в файловой системе вашего компьютера, из которого вы можете взаимодействовать с файлами в файловой системе USB-накопителя. (Обратите внимание, что файлы USB-накопителя не копируются в каталог монтирования — каталог служит только точкой доступа.)

Точки монтирования обычно располагаются внутри каталога — сначала необходимо создать каталог внутри /mnt для использования в качестве точки монтирования USB. Вы можете назвать его как угодно; Я буду использовать общее имя /mnt/mnt/usbdrive
```
# Create a mount point for the USB drive.
# You'll need sudo privileges because /mnt is on the root partition.
sudo mkdir /mnt/usbdrive  # replace 'usbdrive' with whatever you like
```
Вам нужно создать каталог монтирования только один раз — он останется в вашей файловой системе, и вы сможете повторно использовать его в качестве точки монтирования при использовании USB-накопителя.

Затем вы можете смонтировать раздел данных диска в каталог mount с помощью команды:mount
``
# Mount the USB drive by specifying its entry in the `/dev` directory.
# Replace `sdxN` with the data partition identifier shown by `lsblk`, e.g. `sdb1`
sudo mount /dev/sdxN /mnt/usbdrive
``
Обратите внимание, что вы монтируете раздел данных диска (например, ), а не корневое устройство диска (например, ). Убедитесь, что диск правильно смонтирован с помощью —теперь в столбце для записи раздела данных диска должно отображаться , а файлы USB-накопителя должны отображаться в (или в любой другой точке монтирования, которую вы использовали).sdb1sdblsblkMOUNTPOINTS/mnt/usbdrive/mnt/usbdrive

На этом этапе вы можете взаимодействовать с файлами на USB-накопителе из каталога mount в файловой системе вашего компьютера, читая/записывая/копируя так же, как и с любым другим каталогом (но обратите внимание, что вам потребуются привилегии root для записи на диск, если он смонтирован в )./mnt

Устранение неполадок: если чтение или запись не удаются (даже при использовании привилегий root)...
Извлечение USB-накопителя
Безопасное извлечение USB-накопителя состоит из двух шагов: (1) размонтирование раздела данных диска и (2) Выключение накопителя. Сначала размонтируйте раздел данных диска с помощью команды:umount
```
# Unmount the drive's partitions---choose one option.

# Option 1 (yup, "umount" and not "unmount")
umount /mnt/usbdrive  # by specifying mount point (preferred)

# Option 2
umount /dev/sdxN      # by specifying the device partition (not preferred)
``
Вы можете проверить, что диск размонтирован, используя —столбец для записи раздела данных диска теперь должен быть пустым.lsblkMOUNTPOINTS

На этом этапе, вероятно, можно безопасно извлечь диск, но лучше сначала выключить его. Вероятно, это будет проще с помощью команды ', описанной в следующем разделе. Но без сторонних инструментов вы можете выключить диск, записав непосредственно в файлы устройства USB-накопителя (подробнее о файлах устройств Linux), используя привилегии root:udisksctlpower-off
``
# Option 1: works from a normal user shell using sudo
echo 1 | sudo tee /sys/block/sdx/device/delete

# Option 2: works only from a root shell
echo 1 > /sys/block/sdx/device/delete
``
Обратите внимание, что вы нацеливаетесь на корневой диск (например, ), а не на раздел данных (например, ).sdbsdb1

Обратите внимание, что вы не можете этого сделать обычным пользователем, потому что привилегии sudo не передаются через операцию перенаправления, но вы можете обойти это с помощью . Для более подробного обсуждения строки отключения питания см. этот ответ StackExchange и/или ArchWiki: USB-накопитель/устройство не выключается после размонтирования всех разделов.sudo echo 1 >>tee

Современная альтернатива: udisks2
На данный момент в статье рассмотрено все, что вам нужно знать для взаимодействия с USB-накопителями. Можно смело прекращать чтение.

Или, если вам интересно, вот более современный способ монтирования, размонтирования и извлечения дисков с помощью пакета udisks2; Он похож, но, возможно, немного чище, чем традиционный и описанный выше рабочий процесс.mountumount

Я предполагаю, что вы знакомы с материалами монтирования/размонтирования/извлечения ранее в этой статье и продолжаете использовать их для идентификации USB-накопителя и определения раздела данных диска./dev/sdx/dev/sdxN

Ниже приведена основная операция монтирования/отключения/выключения питания с помощью . Вы выполняете все команды с помощью инструмента CLI:udisks2udisksctl

При необходимости установите с помощью udisks2sudo pacman -S udisks2

Подключите USB-накопитель и используйте для монтирования раздела данных накопителя:udisksctl
`
# Mount a drive's data partition
udisksctl mount -b /dev/sdxN
``
Вы найдете файлы диска в каталоге ./run/media/$USER/$DEVICE_UUID

Чтобы извлечь диск, размонтируйте его раздел данных и выключите диск.
``
# Unmount a drive's data partition
udisksctl unmount -b /dev/sdxN

# Power off a drive
udisksctl power-off -b /dev/sdx
``
Несколько замечаний:

Вам не нужны привилегии, чтобы использовать USB-накопители с , что приятно. ( обходит привилегии sudo с помощью списков управления доступом, но я не знаю подробностей.)sudoudisks2udisks2
Флаг используется для указания блочного устройства.-b
По умолчанию монтирует съемные диски и создает точку монтирования с буквенно-цифровым UUID диска (который можно увидеть, например, с помощью ). Это поведение можно настроить, как описано в ArchWiki: Udisks/Mount to /media.udisks2/run/media/$USER/$DEVICE_UUIDlsblk -f
udisksctl вместо того, чтобы размонтировать диски.unmountumount
Выключение диска намного проще, чем запись в файл диска.udisks2device/delete
Автоматическое монтирование с помощью udiskie
Если вы не возражаете против того, чтобы вручную отдавать команды на монтирование USB-накопителей, в этой статье вам больше нечего — смело прекращайте читать.mount

А для тех, кто считает вызов вручную утомительным, вы можете использовать комбинацию с программой, которая определяет, когда вы физически подключаете USB-накопитель, а затем монтирует диск за вас — это называется автоматическим монтированием, и, по сути, сохраняет вам команду, введенную вручную. (Сначала вы должны ознакомиться с разделом udisks2.)mountudisks2mount

Если вы хотите попробовать автомонтирование, я предлагаю использовать udiskie (но полный список помощников монтирования см. в ArchWiki). Вот как автоматически монтировать USB-накопители с помощью:udiskie

Установите пакет udiskie с помощью . Документацию см. в udiskie wiki.pacman -S udiskie

Запустите программу и забудьте о ней — вероятно, проще всего будет автоматически запуститься в качестве фонового процесса из оконного менеджера или среды рабочего стола, в зависимости от того, что подходит для вашей настройки. Если вы новичок в автозапуске программ, я предлагаю сделать крюк и просмотреть эти три раздела ArchWiki, а затем проверить udiskie wiki.udiskieudiskie~/.xinitrc~/.xprofile

Пока он работает, он будет обнаруживать подключенные диски и автоматически монтировать их с помощью (т.е. монтируется точно так же, как ). Вы, вероятно, также будете получать уведомления на рабочем столе, если у вас запущен сервер уведомлений.udiskieudisksctludiskie/run/media/$USER/$DEVICE_UUIDudisksctl

Взаимодействуйте с диском и извлекайте его, как описано ранее в разделе udisks2, т.е. вы по-прежнему вручную извлекаете диск с помощью и .umountpower-off

